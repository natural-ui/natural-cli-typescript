{"remainingRequest":"E:\\workspace-myself\\natural-cli-typescript\\webpack4-react-ts-mobx-antd-ydjfe\\node_modules\\thread-loader\\dist\\cjs.js??ref--7-1!E:\\workspace-myself\\natural-cli-typescript\\webpack4-react-ts-mobx-antd-ydjfe\\node_modules\\babel-loader\\lib\\index.js??ref--7-2!E:\\workspace-myself\\natural-cli-typescript\\webpack4-react-ts-mobx-antd-ydjfe\\src\\containers\\shared\\App\\IntlWrapper.tsx","dependencies":[{"path":"E:\\workspace-myself\\natural-cli-typescript\\webpack4-react-ts-mobx-antd-ydjfe\\src\\containers\\shared\\App\\IntlWrapper.tsx","mtime":1557549177000},{"path":"E:\\workspace-myself\\natural-cli-typescript\\webpack4-react-ts-mobx-antd-ydjfe\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558612017300},{"path":"E:\\workspace-myself\\natural-cli-typescript\\webpack4-react-ts-mobx-antd-ydjfe\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1550204147052},{"path":"E:\\workspace-myself\\natural-cli-typescript\\webpack4-react-ts-mobx-antd-ydjfe\\node_modules\\babel-loader\\lib\\index.js","mtime":1557710044686}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJhbnRkL2xpYi9sb2NhbGUtcHJvdmlkZXIvc3R5bGUiOwppbXBvcnQgX0xvY2FsZVByb3ZpZGVyIGZyb20gImFudGQvbGliL2xvY2FsZS1wcm92aWRlciI7CmltcG9ydCAiYW50ZC9saWIvc2VsZWN0L3N0eWxlIjsKaW1wb3J0IF9TZWxlY3QgZnJvbSAiYW50ZC9saWIvc2VsZWN0IjsKCihmdW5jdGlvbiAoKSB7CiAgdmFyIGVudGVyTW9kdWxlID0gKHR5cGVvZiByZWFjdEhvdExvYWRlckdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyByZWFjdEhvdExvYWRlckdsb2JhbCA6IHJlcXVpcmUoJ3JlYWN0LWhvdC1sb2FkZXInKSkuZW50ZXJNb2R1bGU7CiAgZW50ZXJNb2R1bGUgJiYgZW50ZXJNb2R1bGUobW9kdWxlKTsKfSkoKTsKCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9CgpmdW5jdGlvbiBfc2xpY2VkVG9BcnJheShhcnIsIGkpIHsgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsgfQoKZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpOyB9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7IHZhciBfYXJyID0gW107IHZhciBfbiA9IHRydWU7IHZhciBfZCA9IGZhbHNlOyB2YXIgX2UgPSB1bmRlZmluZWQ7IHRyeSB7IGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsgX2Fyci5wdXNoKF9zLnZhbHVlKTsgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOyB9IH0gY2F0Y2ggKGVycikgeyBfZCA9IHRydWU7IF9lID0gZXJyOyB9IGZpbmFsbHkgeyB0cnkgeyBpZiAoIV9uICYmIF9pWyJyZXR1cm4iXSAhPSBudWxsKSBfaVsicmV0dXJuIl0oKTsgfSBmaW5hbGx5IHsgaWYgKF9kKSB0aHJvdyBfZTsgfSB9IHJldHVybiBfYXJyOyB9CgpmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7IH0KCmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JzsKaW1wb3J0IGludGwgZnJvbSAncmVhY3QtaW50bC11bml2ZXJzYWwnOwppbXBvcnQgeyBmaW5kIH0gZnJvbSAnbG9kYXNoJzsKaW1wb3J0ICogYXMgc3R5bGVzIGZyb20gJy4vaW5kZXguc2Nzcyc7CmltcG9ydCB7IHVzZU9uTW91bnQgfSBmcm9tICdAdXRpbHMvcmVhY3RFeHQnOwppbXBvcnQgeyBzZXRDb29raWUgfSBmcm9tICdAdXRpbHMvaW5kZXgnOwppbXBvcnQgeyBDT09LSUVfS0VZUyB9IGZyb20gJ0Bjb25zdGFudHMvaW5kZXgnOwppbXBvcnQgUGFnZUxvYWRpbmcgZnJvbSAnQGNvbXBvbmVudHMvUGFnZUxvYWRpbmcnOwppbXBvcnQgeyBTVVBQT0VSX0xPQ0FMRVMsIExPQ0FMRVNfS0VZUywgZ2V0TG9jYWxlTG9hZGVyIH0gZnJvbSAnQGxvY2FsZXMvbG9hZGVyJzsKZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gSW50bFdyYXBwZXIoX3JlZikgewogIHZhciBjaGlsZHJlbiA9IF9yZWYuY2hpbGRyZW47CgogIHZhciBfUmVhY3QkdXNlU3RhdGUgPSBSZWFjdC51c2VTdGF0ZSgnJyksCiAgICAgIF9SZWFjdCR1c2VTdGF0ZTIgPSBfc2xpY2VkVG9BcnJheShfUmVhY3QkdXNlU3RhdGUsIDIpLAogICAgICBjdXJyZW50TG9jYWxlID0gX1JlYWN0JHVzZVN0YXRlMlswXSwKICAgICAgc2V0Q3VycmVudExvY2FsZSA9IF9SZWFjdCR1c2VTdGF0ZTJbMV07CgogIHZhciBfUmVhY3QkdXNlU3RhdGUzID0gUmVhY3QudXNlU3RhdGUobnVsbCksCiAgICAgIF9SZWFjdCR1c2VTdGF0ZTQgPSBfc2xpY2VkVG9BcnJheShfUmVhY3QkdXNlU3RhdGUzLCAyKSwKICAgICAgYW50ZExvY2FsZURhdGEgPSBfUmVhY3QkdXNlU3RhdGU0WzBdLAogICAgICBzZXRBbnRkTG9jYWxlRGF0YSA9IF9SZWFjdCR1c2VTdGF0ZTRbMV07CgogIGZ1bmN0aW9uIGxvYWRMb2NhbGVzKCkgewogICAgdmFyIHRhcmdldExvY2FsZSA9IGludGwuZGV0ZXJtaW5lTG9jYWxlKHsKICAgICAgY29va2llTG9jYWxlS2V5OiBDT09LSUVfS0VZUy5MQU5HCiAgICB9KTsgLy8gZGVmYXVsdCBpcyBFbmdsaXNoCgogICAgaWYgKCFmaW5kKFNVUFBPRVJfTE9DQUxFUywgewogICAgICB2YWx1ZTogdGFyZ2V0TG9jYWxlCiAgICB9KSkgewogICAgICB0YXJnZXRMb2NhbGUgPSBMT0NBTEVTX0tFWVMuRU5fVVM7CiAgICB9CgogICAgZ2V0TG9jYWxlTG9hZGVyKHRhcmdldExvY2FsZSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgIGludGwuaW5pdCh7CiAgICAgICAgY3VycmVudExvY2FsZTogdGFyZ2V0TG9jYWxlLAogICAgICAgIGxvY2FsZXM6IF9kZWZpbmVQcm9wZXJ0eSh7fSwgdGFyZ2V0TG9jYWxlLCByZXMubG9jYWxlRGF0YSkKICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgc2V0Q3VycmVudExvY2FsZSh0YXJnZXRMb2NhbGUpOwogICAgICAgIHNldEFudGRMb2NhbGVEYXRhKHJlcy5hbnRkTG9jYWxlRGF0YSk7CiAgICAgIH0pOwogICAgfSk7CiAgfQoKICBmdW5jdGlvbiBvblNlbGVjdExvY2FsZSh2YWwpIHsKICAgIHNldENvb2tpZShDT09LSUVfS0VZUy5MQU5HLCB2YWwpOwogICAgbG9jYXRpb24ucmVsb2FkKCk7CiAgfQoKICB1c2VPbk1vdW50KGxvYWRMb2NhbGVzKTsKCiAgaWYgKCFjdXJyZW50TG9jYWxlKSB7CiAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudChQYWdlTG9hZGluZywgbnVsbCk7CiAgfQoKICB2YXIgc2VsZWN0TGFuZ3VhZ2UgPSBSZWFjdC5jcmVhdGVFbGVtZW50KF9TZWxlY3QsIHsKICAgIGNsYXNzTmFtZTogc3R5bGVzLmludGxTZWxlY3QsCiAgICBvbkNoYW5nZTogb25TZWxlY3RMb2NhbGUsCiAgICB2YWx1ZTogY3VycmVudExvY2FsZQogIH0sIFNVUFBPRVJfTE9DQUxFUy5tYXAoZnVuY3Rpb24gKGwpIHsKICAgIHJldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KF9TZWxlY3QuT3B0aW9uLCB7CiAgICAgIGtleTogbC52YWx1ZSwKICAgICAgdmFsdWU6IGwudmFsdWUKICAgIH0sIGwubmFtZSk7CiAgfSkpOwogIHJldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KF9Mb2NhbGVQcm92aWRlciwgewogICAgbG9jYWxlOiBhbnRkTG9jYWxlRGF0YQogIH0sIFJlYWN0LmNyZWF0ZUVsZW1lbnQoUmVhY3QuRnJhZ21lbnQsIG51bGwsIHNlbGVjdExhbmd1YWdlLCBjaGlsZHJlbikpOwp9CjsKCihmdW5jdGlvbiAoKSB7CiAgdmFyIHJlYWN0SG90TG9hZGVyID0gKHR5cGVvZiByZWFjdEhvdExvYWRlckdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyByZWFjdEhvdExvYWRlckdsb2JhbCA6IHJlcXVpcmUoJ3JlYWN0LWhvdC1sb2FkZXInKSkuZGVmYXVsdDsKCiAgaWYgKCFyZWFjdEhvdExvYWRlcikgewogICAgcmV0dXJuOwogIH0KCiAgcmVhY3RIb3RMb2FkZXIucmVnaXN0ZXIoSW50bFdyYXBwZXIsICJJbnRsV3JhcHBlciIsICJFOlxcd29ya3NwYWNlLW15c2VsZlxcbmF0dXJhbC1jbGktdHlwZXNjcmlwdFxcd2VicGFjazQtcmVhY3QtdHMtbW9ieC1hbnRkLXlkamZlXFxzcmNcXGNvbnRhaW5lcnNcXHNoYXJlZFxcQXBwXFxJbnRsV3JhcHBlci50c3giKTsKfSkoKTsKCjsKCihmdW5jdGlvbiAoKSB7CiAgdmFyIGxlYXZlTW9kdWxlID0gKHR5cGVvZiByZWFjdEhvdExvYWRlckdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyByZWFjdEhvdExvYWRlckdsb2JhbCA6IHJlcXVpcmUoJ3JlYWN0LWhvdC1sb2FkZXInKSkubGVhdmVNb2R1bGU7CiAgbGVhdmVNb2R1bGUgJiYgbGVhdmVNb2R1bGUobW9kdWxlKTsKfSkoKTs="},{"version":3,"sources":["E:\\workspace-myself\\natural-cli-typescript\\webpack4-react-ts-mobx-antd-ydjfe\\src\\containers\\shared\\App\\IntlWrapper.tsx"],"names":["React","intl","find","styles","useOnMount","setCookie","COOKIE_KEYS","PageLoading","SUPPOER_LOCALES","LOCALES_KEYS","getLocaleLoader","IntlWrapper","children","useState","currentLocale","setCurrentLocale","antdLocaleData","setAntdLocaleData","loadLocales","targetLocale","determineLocale","cookieLocaleKey","LANG","value","EN_US","then","res","init","locales","localeData","onSelectLocale","val","location","reload","selectLanguage","intlSelect","map","l","name"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,OAAOC,IAAP,MAAiB,sBAAjB;AACA,SAASC,IAAT,QAAqB,QAArB;AAIA,OAAO,KAAKC,MAAZ,MAAwB,cAAxB;AACA,SAASC,UAAT,QAA2B,iBAA3B;AACA,SAASC,SAAT,QAA0B,cAA1B;AACA,SAASC,WAAT,QAA4B,kBAA5B;AACA,OAAOC,WAAP,MAAwB,yBAAxB;AACA,SAASC,eAAT,EAA0BC,YAA1B,EAAwCC,eAAxC,QAA+D,iBAA/D;AAMA,eAAe,SAASC,WAAT,OAA2C;AAAA,MAApBC,QAAoB,QAApBA,QAAoB;;AAAA,wBACZZ,KAAK,CAACa,QAAN,CAAe,EAAf,CADY;AAAA;AAAA,MAC/CC,aAD+C;AAAA,MAChCC,gBADgC;;AAAA,yBAEVf,KAAK,CAACa,QAAN,CAAuB,IAAvB,CAFU;AAAA;AAAA,MAE/CG,cAF+C;AAAA,MAE/BC,iBAF+B;;AAItD,WAASC,WAAT,GAAuB;AACnB,QAAIC,YAAY,GAAGlB,IAAI,CAACmB,eAAL,CAAqB;AAAEC,MAAAA,eAAe,EAAEf,WAAW,CAACgB;AAA/B,KAArB,CAAnB,CADmB,CAEnB;;AACA,QAAI,CAACpB,IAAI,CAACM,eAAD,EAAkB;AAAEe,MAAAA,KAAK,EAAEJ;AAAT,KAAlB,CAAT,EAAqD;AACjDA,MAAAA,YAAY,GAAGV,YAAY,CAACe,KAA5B;AACH;;AACDd,IAAAA,eAAe,CAACS,YAAD,CAAf,CAA8BM,IAA9B,CAAmC,UAAAC,GAAG,EAAI;AACtCzB,MAAAA,IAAI,CAAC0B,IAAL,CAAU;AAAEb,QAAAA,aAAa,EAAEK,YAAjB;AAA+BS,QAAAA,OAAO,sBAAKT,YAAL,EAAoBO,GAAG,CAACG,UAAxB;AAAtC,OAAV,EAAwFJ,IAAxF,CAA6F,YAAM;AAC/FV,QAAAA,gBAAgB,CAACI,YAAD,CAAhB;AACAF,QAAAA,iBAAiB,CAACS,GAAG,CAACV,cAAL,CAAjB;AACH,OAHD;AAIH,KALD;AAMH;;AAED,WAASc,cAAT,CAAwBC,GAAxB,EAAqC;AACjC1B,IAAAA,SAAS,CAACC,WAAW,CAACgB,IAAb,EAAmBS,GAAnB,CAAT;AACAC,IAAAA,QAAQ,CAACC,MAAT;AACH;;AAED7B,EAAAA,UAAU,CAACc,WAAD,CAAV;;AAEA,MAAI,CAACJ,aAAL,EAAoB;AAChB,WAAO,oBAAC,WAAD,OAAP;AACH;;AACD,MAAMoB,cAAc,GAChB;AAAQ,IAAA,SAAS,EAAE/B,MAAM,CAACgC,UAA1B;AAAsC,IAAA,QAAQ,EAAEL,cAAhD;AAAgE,IAAA,KAAK,EAAEhB;AAAvE,KACKN,eAAe,CAAC4B,GAAhB,CAAoB,UAAAC,CAAC;AAAA,WAClB,4BAAQ,MAAR;AAAe,MAAA,GAAG,EAAEA,CAAC,CAACd,KAAtB;AAA6B,MAAA,KAAK,EAAEc,CAAC,CAACd;AAAtC,OACKc,CAAC,CAACC,IADP,CADkB;AAAA,GAArB,CADL,CADJ;AASA,SACI;AAAgB,IAAA,MAAM,EAAEtB;AAAxB,KACI,oBAAC,KAAD,CAAO,QAAP,QACKkB,cADL,EAEKtB,QAFL,CADJ,CADJ;AAQH;;;;;;;;;;0BA7CuBD,W","sourcesContent":["import * as React from 'react'\nimport intl from 'react-intl-universal'\nimport { find } from 'lodash'\nimport { Select, LocaleProvider } from 'antd'\nimport { Locale } from 'antd/lib/locale-provider'\n\nimport * as styles from './index.scss'\nimport { useOnMount } from '@utils/reactExt'\nimport { setCookie } from '@utils/index'\nimport { COOKIE_KEYS } from '@constants/index'\nimport PageLoading from '@components/PageLoading'\nimport { SUPPOER_LOCALES, LOCALES_KEYS, getLocaleLoader } from '@locales/loader'\n\ninterface IProps {\n    children?: React.ReactNode\n}\n\nexport default function IntlWrapper({ children }: IProps) {\n    const [currentLocale, setCurrentLocale] = React.useState('')\n    const [antdLocaleData, setAntdLocaleData] = React.useState<Locale>(null)\n\n    function loadLocales() {\n        let targetLocale = intl.determineLocale({ cookieLocaleKey: COOKIE_KEYS.LANG })\n        // default is English\n        if (!find(SUPPOER_LOCALES, { value: targetLocale })) {\n            targetLocale = LOCALES_KEYS.EN_US\n        }\n        getLocaleLoader(targetLocale).then(res => {\n            intl.init({ currentLocale: targetLocale, locales: { [targetLocale]: res.localeData } }).then(() => {\n                setCurrentLocale(targetLocale)\n                setAntdLocaleData(res.antdLocaleData)\n            })\n        })\n    }\n\n    function onSelectLocale(val: string) {\n        setCookie(COOKIE_KEYS.LANG, val)\n        location.reload()\n    }\n\n    useOnMount(loadLocales)\n\n    if (!currentLocale) {\n        return <PageLoading />\n    }\n    const selectLanguage = (\n        <Select className={styles.intlSelect} onChange={onSelectLocale} value={currentLocale}>\n            {SUPPOER_LOCALES.map(l => (\n                <Select.Option key={l.value} value={l.value}>\n                    {l.name}\n                </Select.Option>\n            ))}\n        </Select>\n    )\n    return (\n        <LocaleProvider locale={antdLocaleData}>\n            <React.Fragment>\n                {selectLanguage}\n                {children}\n            </React.Fragment>\n        </LocaleProvider>\n    )\n}\n"]}]}